name: Open Source Quality

on:
  push:
    branches: ["**"]
  pull_request:

jobs:
  quality-check:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Validate required OSS files
        run: |
          required=(
            "README.md"
            "README.zh-CN.md"
            "LICENSE"
            "CONTRIBUTING.md"
            "CODE_OF_CONDUCT.md"
            "SECURITY.md"
            ".github/pull_request_template.md"
            ".github/ISSUE_TEMPLATE/bug_report.md"
            ".github/ISSUE_TEMPLATE/feature_request.md"
          )
          for f in "${required[@]}"; do
            if [ ! -f "$f" ]; then
              echo "Missing required file: $f"
              exit 1
            fi
          done

      - name: Check bilingual README links
        run: |
          grep -q "README.zh-CN.md" README.md
          grep -q "README.md" README.zh-CN.md

      - name: Check SEO meta tags
        run: |
          grep -q 'meta name="description"' CLIProxyAPI/static/management.html
          grep -q 'meta name="keywords"' CLIProxyAPI/static/management.html
